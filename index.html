<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Add Trainer - STEMify Admin</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    * { box-sizing: border-box; }
    body {
      font-family: 'Inter', sans-serif;
      background: linear-gradient(135deg, #0d2137 0%, #1a3a52 100%);
      min-height: 100vh;
      margin: 0;
      padding: 24px;
      color: #e8eef2;
    }
    .wrap {
      max-width: 560px;
      margin: 0 auto;
    }
    h1 {
      font-size: 1.75rem;
      font-weight: 700;
      margin-bottom: 8px;
    }
    .subtitle { color: rgba(255,255,255,0.7); margin-bottom: 28px; font-size: 0.95rem; }
    .card {
      background: rgba(255,255,255,0.06);
      border: 1px solid rgba(255,255,255,0.12);
      border-radius: 16px;
      padding: 28px;
      margin-bottom: 20px;
    }
    label {
      display: block;
      font-weight: 500;
      margin-bottom: 6px;
      font-size: 0.9rem;
    }
    input, textarea {
      width: 100%;
      padding: 12px 14px;
      border: 1px solid rgba(255,255,255,0.2);
      border-radius: 10px;
      background: rgba(0,0,0,0.2);
      color: #fff;
      font-size: 1rem;
      margin-bottom: 16px;
    }
    input::placeholder, textarea::placeholder { color: rgba(255,255,255,0.4); }
    textarea { min-height: 90px; resize: vertical; }
    .hint {
      font-size: 0.8rem;
      color: rgba(255,255,255,0.5);
      margin-top: -10px;
      margin-bottom: 16px;
    }
    .row2 { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; }
    @media (max-width: 500px) { .row2 { grid-template-columns: 1fr; } }
    button {
      background: #28a745;
      color: #fff;
      border: none;
      padding: 14px 28px;
      border-radius: 10px;
      font-weight: 600;
      font-size: 1rem;
      cursor: pointer;
      width: 100%;
    }
    button:hover { background: #218838; }
    button:disabled { opacity: 0.6; cursor: not-allowed; }
    .msg {
      padding: 12px 16px;
      border-radius: 10px;
      margin-bottom: 16px;
      display: none;
    }
    .msg.show { display: block; }
    .msg.success { background: rgba(40,167,69,0.25); border: 1px solid rgba(40,167,69,0.5); }
    .msg.error { background: rgba(220,53,69,0.25); border: 1px solid rgba(220,53,69,0.5); }
    .back { color: rgba(255,255,255,0.8); text-decoration: none; font-size: 0.9rem; display: inline-block; margin-bottom: 20px; }
    .back:hover { color: #fff; }
  </style>
</head>
<body>
  <div class="wrap">
    <h1>Add a trainer</h1>
    <p class="subtitle">Fill in the details. Photo URL should be a direct image link (e.g. Google Drive: share image → Get link → use format <code>https://drive.google.com/uc?export=view&id=FILE_ID</code>).</p>

    <div id="msg" class="msg"></div>

    <form id="form" class="card">
      <label for="name">Full name</label>
      <input type="text" id="name" placeholder="e.g. M. Mahmoud Nabawy" required>

      <label for="title">Title / role</label>
      <input type="text" id="title" placeholder="e.g. Professeur de français" required>

      <label for="description">Short description</label>
      <textarea id="description" placeholder="Expert in French language education..."></textarea>

      <label for="photoUrl">Photo URL (Google Drive or any direct image link)</label>
      <input type="url" id="photoUrl" placeholder="https://drive.google.com/uc?export=view&id=...">
      <p class="hint">Use a direct image URL. For Drive: Share → Get link → change to: https://drive.google.com/uc?export=view&id=YOUR_FILE_ID</p>

      <p style="margin-bottom:8px; font-weight:500;">Social / contact links</p>
      <div class="row2">
        <div>
          <label for="phone">Phone (tel: link)</label>
          <input type="text" id="phone" placeholder="+201234567890">
        </div>
        <div>
          <label for="whatsapp">WhatsApp (full URL or number)</label>
          <input type="text" id="whatsapp" placeholder="https://wa.me/201234567890">
        </div>
      </div>
      <label for="email">Email (mailto: or link)</label>
      <input type="text" id="email" placeholder="mailto:teacher@example.com">

      <button type="submit" id="btn">Add trainer</button>
    </form>
  </div>

  <!-- Load your Firebase config (create firebase-config.js from firebase-config.example.js) -->
  <script src="firebase-config.js"></script>
  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

  <script>
    (function() {
      // Use firebase-config.js (copy from firebase-config.example.js) or set config below:
      var firebaseConfig = window.STEMIFY_FIREBASE_CONFIG || {
        apiKey: "YOUR_API_KEY",
        authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
        projectId: "YOUR_PROJECT_ID",
        storageBucket: "YOUR_PROJECT_ID.appspot.com",
        messagingSenderId: "YOUR_SENDER_ID",
        appId: "YOUR_APP_ID"
      };

      if (!firebaseConfig || firebaseConfig.projectId === "YOUR_PROJECT_ID") {
        showMsg('Set your Firebase config in firebase-config.js (copy from firebase-config.example.js) or in this file.', true);
        document.getElementById('btn').disabled = true;
        return;
      }

      try {
        firebase.initializeApp(firebaseConfig);
      } catch (e) {
        showMsg('Firebase init failed: ' + e.message, true);
        document.getElementById('btn').disabled = true;
        return;
      }

      var db = firebase.firestore();

      function showMsg(text, isError) {
        var el = document.getElementById('msg');
        el.textContent = text;
        el.className = 'msg show ' + (isError ? 'error' : 'success');
      }

      function toLink(value, type) {
        if (!value || !value.trim()) return '';
        var v = value.trim();
        if (v.startsWith('http') || v.startsWith('mailto:') || v.startsWith('tel:')) return v;
        if (type === 'phone') return 'tel:' + v.replace(/\s/g, '');
        if (type === 'email') return v.indexOf('@') !== -1 ? 'mailto:' + v : v;
        if (type === 'whatsapp') return v.match(/^\d+/) ? 'https://wa.me/' + v.replace(/\D/g, '') : v;
        return v;
      }

      document.getElementById('form').addEventListener('submit', function(e) {
        e.preventDefault();
        var btn = document.getElementById('btn');
        btn.disabled = true;

        var payload = {
          name: document.getElementById('name').value.trim(),
          title: document.getElementById('title').value.trim(),
          description: document.getElementById('description').value.trim() || '',
          photoUrl: document.getElementById('photoUrl').value.trim() || '',
          socialLinks: {
            phone: toLink(document.getElementById('phone').value, 'phone'),
            whatsapp: toLink(document.getElementById('whatsapp').value, 'whatsapp'),
            email: toLink(document.getElementById('email').value, 'email')
          },
          createdAt: firebase.firestore.FieldValue.serverTimestamp()
        };

        db.collection('trainers').add(payload)
          .then(function() {
            showMsg('Trainer added successfully. He/She will appear on the Trainers page and on the dashboard.');
            document.getElementById('form').reset();
            btn.disabled = false;
          })
          .catch(function(err) {
            showMsg('Error: ' + err.message, true);
            btn.disabled = false;
          });
      });
    })();
  </script>
</body>
</html>
